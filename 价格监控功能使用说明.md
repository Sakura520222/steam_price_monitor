# Steam价格监控功能使用说明

## 功能概述

本插件为Steam商店插件添加了价格监控功能，可以自动监控游戏价格变动并在价格变化时发送通知。

## 配置选项

在插件配置中，新增了两个配置项：

1. **PRICE_MONITOR_INTERVAL** - 价格监控检查间隔（分钟）
   - 默认值：30分钟
   - 建议范围：30-60分钟

2. **ENABLE_PRICE_MONITOR** - 启用价格监控功能
   - 默认值：true
   - 设置为false可禁用价格监控功能

## 使用命令

### 1. 订阅价格监控
```
/价格监控 <游戏名或AppID>
```
**别名：** `/订阅价格`、`/监控价格`

**示例：**
- `/价格监控 Cyberpunk 2077`
- `/价格监控 1091500`
- `/价格监控 千恋万花`
- `/价格监控 赛博朋克 2077`

**功能：**
- 通过游戏名或AppID订阅游戏价格监控
- 支持中文游戏名自动翻译
- 订阅成功后，插件会定期检查价格变动

### 2. 取消价格监控
```
/取消监控 <游戏名或AppID>
```
**别名：** `/取消订阅`、`/停止监控`

**示例：**
- `/取消监控 Cyberpunk 2077`
- `/取消监控 1091500`

**功能：**
- 取消对指定游戏的价格监控订阅
- 支持通过游戏名或AppID取消

### 3. 查看监控列表
```
/监控列表
```

**功能：**
- 查看当前用户订阅的所有价格监控游戏
- 显示游戏名称和当前记录的价格

## 价格变动通知

当监控的游戏价格发生变化时，插件会自动发送通知：

### 通知内容
- 🎉 游戏免费通知
- ⬆️ 价格上涨通知  
- ⬇️ 价格下跌通知
- 变动前后价格对比
- 当前折扣信息
- Steam商店链接

### 通知格式示例
```
⬇️ 游戏《Cyberpunk 2077》价格下跌：¥-149.00
变动前价格：¥298.00
当前价格：¥149.00
原价：¥298.00
折扣：50%
购买链接：https://store.steampowered.com/app/1091500
```

## 技术实现

### 价格获取方式
- 使用Steam官方API获取实时价格信息
- 支持中国区价格监控
- 自动处理免费游戏和折扣信息

### 监控机制
- 基于APScheduler的异步定时任务
- 线程安全的监控列表管理
- 自动保存和加载监控配置

### 数据存储
- 监控列表保存在插件数据目录
- JSON格式存储，便于备份和迁移
- 自动创建数据目录和配置文件

## 注意事项

1. **API限制**：Steam API有请求频率限制，请合理设置监控间隔
2. **网络稳定性**：需要稳定的网络连接来获取价格信息
3. **游戏可用性**：某些游戏可能在中国区不可用或没有价格信息
4. **免费游戏**：免费游戏会显示为价格0元，不会触发价格变动通知

## 故障排除

### 常见问题

**Q: 为什么收不到价格变动通知？**
A: 请检查：
- 插件是否已正确配置API密钥
- 网络连接是否正常
- 监控间隔设置是否合理

**Q: 如何查看当前监控的游戏？**
A: 使用 `/监控列表` 命令查看当前订阅的游戏

**Q: 如何完全禁用价格监控功能？**
A: 在插件配置中将 `ENABLE_PRICE_MONITOR` 设置为 false

## 版本信息

- **版本：** 1.0.0
- **依赖：** httpx, beautifulsoup4, apscheduler
- **兼容性：** AstrBot框架

---

如有问题或建议，请参考插件文档或联系开发者。